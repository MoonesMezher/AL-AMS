# نظام المحاسبة والمخزون - Accounting Management System (AMS)

نظام محاسبة ومخزون متكامل يعمل كـ **مشروع واحد** على **host واحد**. الواجهة الأمامية والخلفية متكاملان في خادم Express واحد.

## المميزات

### ✅ مشروع موحد
- **Frontend + Backend في مكان واحد**: جميع الملفات في مشروع واحد
- **نشر سهل**: نشر على host واحد فقط
- **لا حاجة لبناء**: يعمل مباشرة بدون build steps

### ✅ المزامنة عبر الأجهزة
- **مزامنة تلقائية**: جميع البيانات متزامنة عبر جميع الأجهزة
- **تسجيل دخول واحد**: تسجيل دخول واحد يبقى نشطاً لمدة 30 يوم
- **عمل بدون إنترنت**: يعمل محلياً عند انقطاع الإنترنت
- **مزامنة تلقائية**: عند عودة الاتصال، يتم مزامنة البيانات تلقائياً

### ✅ الوظائف الأساسية
- **إدارة المخزون**: إدارة الفئات والمنتجات مع تتبع المخزون
- **المعاملات المالية**: بيع، شراء، ومصروفات
- **الدائنين والمدينين**: تتبع المدفوعات والمستحقات
- **التقارير**: تقارير شاملة للربح، المبيعات، والفئات
- **أسعار الصرف**: دعم العملات المتعددة مع تحويل تلقائي
- **النسخ الاحتياطي**: تصدير واستيراد البيانات

## التثبيت السريع

### 1. تثبيت المتطلبات

```bash
npm install
```

### 2. تشغيل الخادم

```bash
npm start
```

الخادم سيعمل على: `http://localhost:3000`

### 3. فتح التطبيق

افتح المتصفح واذهب إلى: `http://localhost:3000`

### 4. تسجيل الدخول

- البريد الإلكتروني: `admin@example.com`
- كلمة المرور: `admin123`

**ملاحظة**: تسجيل الدخول يبقى نشطاً لمدة 30 يوم، لن تحتاج لتسجيل الدخول في كل مرة

## هيكل المشروع

```
Source/
├── server.js              # خادم Express (Frontend + Backend)
├── package.json           # ملف التبعيات
├── data.json              # قاعدة البيانات JSON (يتم إنشاؤها تلقائياً)
├── index.html             # الصفحة الرئيسية
├── manifest.json          # ملف PWA Manifest
├── sw.js                  # Service Worker
├── styles/
│   └── main.css          # التنسيقات الرئيسية
└── js/
    ├── api.js            # مدير API للاتصال بالخادم
    ├── storage.js        # إدارة التخزين المحلي والAPI
    ├── auth.js           # نظام المصادقة
    ├── inventory.js      # إدارة المخزون
    ├── transactions.js    # إدارة المعاملات
    ├── creditors-debtors.js # الدائنين والمدينين
    ├── reports.js        # التقارير
    ├── settings.js       # الإعدادات
    ├── help.js           # التعليمات
    ├── ui.js             # مساعدات الواجهة
    └── app.js            # التطبيق الرئيسي
```

## النشر

### النشر على Host واحد

المشروع جاهز للنشر على أي host يدعم Node.js:

1. **رفع الملفات** إلى الخادم
2. **تثبيت التبعيات**: `npm install`
3. **تشغيل الخادم**: `npm start`

راجع `DEPLOY.md` للتفاصيل الكاملة عن النشر.

### استخدام PM2 (موصى به)

```bash
npm install -g pm2
pm2 start server.js --name accounting-app
pm2 save
```

## كيفية العمل

### المزامنة التلقائية
1. عند تسجيل الدخول، يتم جلب جميع البيانات من الخادم
2. جميع التغييرات تُحفظ محلياً أولاً (للدعم بدون إنترنت)
3. ثم يتم إرسالها للخادم تلقائياً عند الاتصال بالإنترنت
4. عند فتح التطبيق من جهاز آخر، يتم جلب أحدث البيانات من الخادم

### العمل بدون إنترنت
- التطبيق يعمل بشكل كامل بدون إنترنت
- جميع البيانات تُحفظ محلياً في IndexedDB
- عند عودة الاتصال، يتم مزامنة التغييرات تلقائياً

## API Endpoints

جميع الـ API endpoints تبدأ بـ `/api`:

- `POST /api/users/login` - تسجيل الدخول
- `GET /api/categories` - جلب الفئات
- `POST /api/categories` - إضافة فئة
- `GET /api/products` - جلب المنتجات
- `POST /api/products` - إضافة منتج
- `GET /api/transactions` - جلب المعاملات
- `POST /api/transactions` - إضافة معاملة
- `GET /api/sync` - جلب جميع البيانات دفعة واحدة

## المتطلبات

- Node.js 14+ 
- npm أو yarn

## الدعم

للمساعدة أو الإبلاغ عن مشاكل، يرجى فتح issue في المستودع.

## الترخيص

هذا المشروع مفتوح المصدر ومتاح للاستخدام الحر.
